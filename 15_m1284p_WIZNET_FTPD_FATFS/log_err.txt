Обычно после первого соединения после перезагрузки,
после рестарта FTPD(Xlight FTP Server Win7) все восстанавливается (висим на старом сокете?)
//?? Freeze connection (<1> View FTPD directory)
1

Rcvd Command: 200 PORT command successful

3:FTPDataStart [ACTIVE_MODE], port : 35000
3:Opened
3:Listen ok

Rcvd Command: 150 Opening ASCII mode data connection for /bin/ls (2608 bytes).

.. here freeze..

//OK connection (<1> View FTPD directory)
1

Rcvd Command: 200 PORT command successful

3:FTPDataStart [ACTIVE_MODE], port : 35000
3:Opened
3:Listen ok

>>>3:FTP Data socket Connected
~364
    switch(getSn_SR(DATA_SOCK)){
    	case SOCK_ESTABLISHED :
    		if(!connect_state_data_ftpc){
    			PRINTF("%d:FTP Data socket Connected\r\n", DATA_SOCK);
    			connect_state_data_ftpc = 1;
    		}
			if(gDataPutGetStart){
				switch(Command.Second){
				case s_dir:
					PRINTF("dir waiting...\r\n");


Rcvd Command: 150 Opening ASCII mode data connection for /bin/ls (2608 bytes).

dir waiting...
dir waiting...
dir waiting...
dir waiting...

FTP server root file list:
===============================================
drw-rw-rw- 1 ftp ftp                0 Dec 26 10:18 .
..
-rw-rw-rw- 1 ftp ftp             5576 Jun 25  2013 sw_on.png
===============================================

Rcvd Command: 226 Transfer complete (16.300 KB/s).

3:CloseWait
3:Closed


28/12/18
ftpd.c
PORT/STOR error (i.e. WIN7 ftp <put>) on <15_m1284p_WIZNET_FTPD_FATFS_v1.0>

2:FTP Connected
size: 16
Rcvd Command: USER anonymous
USER_CMD : anonymous
size: 19
Rcvd Command: PASS maxx@maxxpc1
PASS_CMD : maxx@maxxpc1
anonymous logged in

//!! From here read carefully!! 
size: 28
Rcvd Command: PORT 192,168,0,100,216,212
PORT_CMD
ip : 192.168.0.100, port : 55508
3:FTPDataStart[ACTIVE_MODE], port : 20
3:Opened
3:FTP Data socket Connected
size: 17
Rcvd Command: STOR indexA.htm
>>[870]STOR_CMD
3:Connect error
To ip : 192.168.0.100, port : 55508
filename to store : /indexA.htm 11
f_open return FR_OK
